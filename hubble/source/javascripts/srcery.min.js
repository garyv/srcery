// Srcery -> http://github.com/garyv/srcery
var Srcery=function(){var f=document,n=2.5,g=window,b,k,l,e,p,d,q,s,t,c,m,u,r,h;imgs=f.querySelectorAll?f.querySelectorAll("img[data-srcset]"):f.getElementsByTagName("img");c=function(){return arguments.length-2?c(arguments[0],arguments[1])!=arguments[2]&&arguments[0].setAttribute(arguments[1],arguments[2]):arguments[0].getAttribute(arguments[1])};m=function(a,b){g.addEventListener?this.addEventListener(a,b,!1):g.attachEvent?this.attachEvent("on"+a,b):this["on"+a]=b};u=function(a){a=a.getBoundingClientRect(); return a.left>=0-n*viewportHeight()&&a.top<=n*viewportHeight()};r=function(a){if(d=c(a,"data-srcset"))for(c(a,"data-original-src")||c(a,"data-original-src",c(a,"src")),d=d.split(/, ?/),e=0;e<d.length;e++)if(d[e].match(/\dw$/)){if(t=+d[e].match(/\d+(?=w$)/),t<=s){p=d[e].split(/ /)[0];c(a,"src")!=p&&c(a,"src",p);break}}else c(a,"src",d[e])};h=function(){if(!k){k=!0;s=viewportWidth();b=0;for(l=imgs.length;b<l;b++)u(imgs[b])&&r(imgs[b]);setTimeout(function(){k=!1},200)}};viewportHeight=function(){return q= q||g.innerHeight||f.documentElement.clientHeight};viewportWidth=function(){return(g.innerWidth||f.body.parentNode.clientWidth)*(g.devicePixelRatio||1)};m("load",h);m("orientationchange",function(){q=0;k=!1;h()});m("scroll",h);h();return{setEagerness:function(a){n=a},push:function(a){return imgs.push(a)},now:function(){b=0;for(l=imgs.length;b<l;b++)r(imgs[b])}}}();